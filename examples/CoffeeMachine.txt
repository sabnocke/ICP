name CoffeeMachine
# Simulace automatu kávovaru s mletím, extrakcí, výdejem a čištěním.
Input:
Output: status

Variables:
    int tIdle     = 2000   # pauza před prvním cyklem
    int tGrind    = 3000   # mlýnek
    int tBrew     = 4000   # extrakce
    int tDispense = 2000   # výdej kávy
    int tClean    = 5000   # čištění
    int cycles    = 3      # kolikrát opakovat přípravu
    int count     = 0      # aktuální cyklus
States:
    state IDLE     [ return "IDLE: cekam pred cyklem"; ]
    state GRIND    [ return "GRIND: mleti zrn"; ]
    state BREW     [ return "BREW: priprava kavy"; ]
    state DISPENSE [ return "DISPENSE: vydej do salku"; ]
    state CLEAN    [ count = count + 1; return "CLEAN: cisteni (" .. tonumber(count) .. "/" .. tonumber(cycles) .. ")"; ]
    state STOPPED  [ return "STOPPED: konec cyklu"; ]
Transitions:
    IDLE     --> GRIND    : [ count < cycles ] @ tIdle
    IDLE     --> STOPPED  : [ count >= cycles ] @ tIdle
    GRIND    --> BREW     : @ tGrind
    BREW     --> DISPENSE : @ tBrew
    DISPENSE --> CLEAN    : @ tDispense
    CLEAN    --> IDLE     : [ count < cycles ] @ tClean
    CLEAN    --> STOPPED  : [ count >= cycles ] @ tClean 
